(this["webpackJsonpwhatsapp-clone"]=this["webpackJsonpwhatsapp-clone"]||[]).push([[0],{100:function(e,t,c){},101:function(e,t,c){"use strict";c.r(t);var n=c(4),a=c.n(n),s=c(44),o=c.n(s),i=(c(82),c(15)),r=(c(83),c(84),c(85),c(117)),l=c(69),j=c.n(l),d=c(41);c(87),c(67);d.a.initializeApp({apiKey:"AIzaSyAqhxaavexuk1KTXCGqs8YTJq9sZK3cLnc",authDomain:"whatsapp-clone-66940.firebaseapp.com",projectId:"whatsapp-clone-66940",storageBucket:"whatsapp-clone-66940.appspot.com",messagingSenderId:"1034576981421",appId:"1:1034576981421:web:203418d9385ea1d1614524",measurementId:"G-97WZ5SH7KT"});var u=d.a.firestore(),h=d.a.auth(),b=new d.a.auth.GoogleAuthProvider,m=(d.a,c(50)),O=c(10);var p=function(e){var t,c=e.id,a=e.name,s=e.addnewchat,o=Object(n.useState)(""),l=Object(i.a)(o,2),d=l[0],h=l[1],b=Object(n.useState)([]),p=Object(i.a)(b,2),f=p[0],x=p[1];return Object(n.useEffect)((function(){c&&u.collection("room").doc(c).collection("messages").orderBy("timestamp","desc").get().then((function(e){return x(e.docs.map((function(e){return e.data()})))})).catch((function(e){console.log("Error getting sidebarmessages: ",e)}))}),[c]),Object(n.useEffect)((function(){h(Math.floor(5e3*Math.random()))}),[]),s?Object(O.jsx)("div",{onClick:function(){var e=prompt("Please enter name for chat");e&&u.collection("room").add({name:e}).then((function(){console.log("Document successfully written!")})).catch((function(e){console.error("Error writing document: ",e)}))},className:"sidebarchat",children:Object(O.jsx)("h2",{children:"Add New Chat"})}):Object(O.jsx)(m.b,{to:"/room/".concat(c),children:Object(O.jsxs)("div",{className:"sidebarchat",children:[Object(O.jsx)(r.a,{src:"https://avatars.dicebear.com/api/human/".concat(d,".svg")}),Object(O.jsxs)("div",{className:"sidebarchat-info",children:[Object(O.jsx)("h3",{children:a}),Object(O.jsx)("p",{children:null===(t=f[0])||void 0===t?void 0:t.message})]}),Object(O.jsx)("span",{children:Object(O.jsx)(j.a,{onClick:function(e){e.preventDefault(),u.collection("room").doc(c).delete().then((function(){console.log("Document successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)}))}})})]})})},f=c(61),x=c.n(f),g=c(116),v=c(70),N=c.n(v),w=c(71),y=c.n(w),S=c(60),C=c.n(S),E=Object(n.createContext)(),D=function(e){var t=e.reducer,c=e.initialState,a=e.children;return Object(O.jsx)(E.Provider,{value:Object(n.useReducer)(t,c),children:a})},I=function(){return Object(n.useContext)(E)},k=c(65),T="set-user",A=function(e,t){switch(console.log(t),t.type){case T:return Object(k.a)(Object(k.a)({},e),{},{user:t.user});default:return e}};var M=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),c=t[0],a=t[1],s=I(),o=Object(i.a)(s,2),l=o[0].user,j=o[1];return Object(n.useEffect)((function(){u.collection("room").get().then((function(e){a(e.docs.map((function(e){return{id:e.id,data:e.data()}})))})).catch((function(e){console.log("Error getting documents: ",e)}))}),[c]),Object(O.jsxs)("div",{className:"sidebar",children:[Object(O.jsxs)("div",{className:"sidebar-header",children:[Object(O.jsx)(r.a,{src:null===l||void 0===l?void 0:l.photoURL,onClick:function(){l&&window.confirm("would you really signout? ")&&h.signOut().then((function(){console.log("user signout"),j({type:T,user:null})})).catch((function(e){console.log("error  to signout",e)}))}}),Object(O.jsxs)("div",{className:"sidebar-headerright",children:[Object(O.jsx)(g.a,{children:Object(O.jsx)(N.a,{})}),Object(O.jsx)(g.a,{children:Object(O.jsx)(y.a,{})}),Object(O.jsx)(g.a,{children:Object(O.jsx)(C.a,{})})]})]}),Object(O.jsx)("div",{className:"sidebar-search",children:Object(O.jsxs)("div",{className:"sidebar-searchcontainer",children:[Object(O.jsx)(x.a,{}),Object(O.jsx)("input",{placeholder:"Search or start new chat",type:"text"})]})}),Object(O.jsxs)("div",{className:"sidebar-chat",children:[Object(O.jsx)(p,{addnewchat:!0}),c&&c.map((function(e){return Object(O.jsx)(p,{id:e.id,name:e.data.name},e.id)}))]})]})};c(99);var P=function(){var e=I(),t=Object(i.a)(e,2),c=(t[0].user,t[1]);return Object(O.jsx)("div",{className:"login",children:Object(O.jsxs)("div",{className:"login-container",children:[Object(O.jsx)("img",{src:"https://img.generation-nt.com/0001654473.jpg",alt:""}),Object(O.jsx)("div",{className:"login-text",children:Object(O.jsx)("h1",{children:"Signin to WhatsApp"})}),Object(O.jsx)("button",{type:"submit",onClick:function(){h.signInWithPopup(b).then((function(e){c({type:T,user:e.user})})).catch((function(e){return alert(e.message)}))},children:"Sign In With Google"})]})})},B=(c(100),c(72)),F=c.n(B),G=c(73),K=c.n(G),L=c(74),W=c.n(L),q=c(18);var J=function(){var e,t,c=I(),a=Object(i.a)(c,2),s=a[0].user,o=(a[1],Object(n.useState)("")),l=Object(i.a)(o,2),j=l[0],h=l[1],b=Object(n.useState)(""),m=Object(i.a)(b,2),p=m[0],f=m[1],v=Object(q.f)().roomId,N=Object(n.useState)(""),w=Object(i.a)(N,2),y=w[0],S=w[1],E=Object(n.useState)([]),D=Object(i.a)(E,2),k=D[0],T=D[1];return Object(n.useEffect)((function(){v&&(u.collection("room").doc(v).get().then((function(e){S(e.data().name)})).catch((function(e){console.log("Error getting documents: ",e)})),u.collection("room").doc(v).collection("messages").orderBy("timestamp","asc").get().then((function(e){T(e.docs.map((function(e){return e.data()})))})).catch((function(e){console.log("Error getting messages: ",e)})))}),[v]),console.log("messages",k),Object(n.useEffect)((function(){f(Math.floor(5e3*Math.random()))}),[]),Object(O.jsxs)("div",{className:"chat",children:[Object(O.jsxs)("div",{className:"chat-header",children:[Object(O.jsx)(r.a,{src:"https://avatars.dicebear.com/api/human/".concat(p,".svg")}),Object(O.jsxs)("div",{className:"chat-headerinfo",children:[Object(O.jsx)("h4",{children:y}),Object(O.jsxs)("p",{children:[s?"online":new Date(null===(e=k[k.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()," "]})]}),Object(O.jsxs)("div",{className:"chat-headerright",children:[Object(O.jsx)(g.a,{children:Object(O.jsx)(x.a,{})}),Object(O.jsx)(g.a,{children:Object(O.jsx)(F.a,{})}),Object(O.jsx)(g.a,{children:Object(O.jsx)(C.a,{})})]})]}),Object(O.jsx)("div",{className:"chat-body",children:k.map((function(e){var t;return Object(O.jsxs)("p",{className:"chat-receiver ".concat(e.name===s.displayName&&"chat-message"),children:[" ",Object(O.jsx)("span",{className:"chat-name",children:e.name}),e.message,Object(O.jsx)("span",{className:"chat-timestamp",children:new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()})]})}))}),Object(O.jsxs)("div",{className:"chat-footer",children:[Object(O.jsx)(K.a,{}),Object(O.jsxs)("form",{children:[Object(O.jsx)("input",{type:"text",value:j,onChange:function(e){return h(e.target.value)},placeholder:"type a message"}),Object(O.jsx)("button",{onClick:function(e){e.preventDefault(),console.log("input",j),u.collection("room").doc(v).collection("messages").add({message:j,name:s.displayName,timestamp:d.a.firestore.FieldValue.serverTimestamp()}).then((function(){console.log("Document successfully written!")})).catch((function(e){console.error("Error writing input: ",e)})),h("")},type:"submit",children:"Send a Message"})]}),Object(O.jsx)(W.a,{})]})]})};var U=function(){var e=I(),t=Object(i.a)(e,2),c=t[0].user;return t[1],Object(O.jsx)("div",{className:"app",children:c?Object(O.jsx)("div",{className:"app-body",children:Object(O.jsx)(m.a,{children:Object(O.jsxs)(q.c,{children:[Object(O.jsxs)(q.a,{path:"/room/:roomId",children:[Object(O.jsx)(M,{}),Object(O.jsx)(J,{})]}),Object(O.jsxs)(q.a,{path:"/",children:[Object(O.jsx)(M,{}),Object(O.jsx)(J,{})]})]})})}):Object(O.jsx)(P,{})})},z=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,118)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,s=t.getLCP,o=t.getTTFB;c(e),n(e),a(e),s(e),o(e)}))};o.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(D,{initialState:{user:null},reducer:A,children:Object(O.jsx)(U,{})})}),document.getElementById("root")),z()},82:function(e,t,c){},83:function(e,t,c){},84:function(e,t,c){},85:function(e,t,c){},99:function(e,t,c){}},[[101,1,2]]]);
//# sourceMappingURL=main.f9112786.chunk.js.map